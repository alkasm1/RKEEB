<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù†Ø¸Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© ÙˆÙ…ÙƒØ§ÙØ­Ø© Ø§Ù„ØªØ²ÙˆÙŠØ±</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f2f2f2; }
    .compare-section { background: #fff; padding: 20px; border-radius: 10px; }
    h3 { margin-top: 20px; color: #333; }
    button, input[type="file"] {
      padding: 10px; margin-top: 10px; width: 100%;
      border-radius: 6px; border: none; background: #0078D7; color: white;
    }
    canvas { border: 1px solid #ccc; margin-top: 15px; max-width: 100%; }
    #matchResult { margin-top: 15px; font-size: 16px; font-weight: bold; }
  </style>
</head>
<body>
  <div class="compare-section">
    <h3>ğŸ“¸ ØªØµÙˆÙŠØ± Ù…Ø¨Ø§Ø´Ø±</h3>
    <button onclick="activateCameraCompare()">Ø§Ø¨Ø¯Ø£ ØªØµÙˆÙŠØ± Ø§Ù„ÙˆØ±Ù‚ØªÙŠÙ†</button>

    <h3>ğŸ–¼ï¸ ØªØ­Ù…ÙŠÙ„ ÙŠØ¯ÙˆÙŠ</h3>
    <input type="file" id="uploadImage" accept="image/*">
    <button onclick="triggerSingle()">ğŸ” ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ù…Ø§Ø¯Ø©</button>

    <h3>ğŸ”² Ø§Ø®ØªÙŠØ§Ø± Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©</h3>
    <canvas id="selectionCanvas" width="600" height="400"></canvas>
    <p>Ø­Ø¯Ø¯ Ù…Ù†Ø·Ù‚ØªÙŠÙ† ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø£Ùˆ Ø¯Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙ‚Ø³Ù… Ø§Ù„ØµÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</p>

    <button onclick="showFinalMatch()">âœ… Ø¹Ø±Ø¶ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙˆØ±Ù‚ØªÙŠÙ†</button>
    <div id="matchResult"></div>
  </div>

  <script>
    function activateCameraCompare() {
      alert("Ù…ÙŠØ²Ø© Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø³ØªØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ø¹Ø¨Ø± WebRTC Ø£Ùˆ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø§Ø­Ù‚Ù‹Ø§.");
    }

    function triggerSingle() {
      const imageInput = document.getElementById('uploadImage');
      if (!imageInput.files[0]) return alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹.");
      const reader = new FileReader();
      reader.onload = function (e) {
        const img = new Image();
        img.onload = () => drawCanvas(img);
        img.src = e.target.result;
      };
      reader.readAsDataURL(imageInput.files[0]);
    }

    function drawCanvas(img) {
      const canvas = document.getElementById("selectionCanvas");
      const ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      // ØªÙ‚Ø³ÙŠÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ù„Ù‰ Ù…Ù†Ø·Ù‚ØªÙŠÙ†:
      const region1 = ctx.getImageData(50, 50, 100, 100);
      const region2 = ctx.getImageData(450, 250, 100, 100);
      const result = evaluateMaterialMatch(region1, region2);
      document.getElementById("matchResult").innerText = Ø¯Ø±Ø¬Ø© Ø§Ù„ØªØ·Ø§Ø¨Ù‚: ${Math.round(result.finalScore)}Ùª;
    }

    function compareHistograms(r1, r2) {
      // ØªØ¨Ø³ÙŠØ·: ÙØ±Ù‚ Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¨ÙƒØ³Ù„
      let diff = 0;
      for (let i = 0; i < r1.data.length; i += 4) {
        diff += Math.abs(r1.data[i] - r2.data[i]);
      }
      return 100 - Math.min(100, diff / (r1.data.length / 4));
    }

    function compareTextureLBP(r1, r2) {
      // Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø¨Ø¯Ø£ Ù†Ø³ÙŠØ¬ÙŠ Ø¨Ø³ÙŠØ·: ÙØ±Ù‚ Ø­Ø¯Ø© Ø§Ù„Ø¨ÙƒØ³Ù„
      let sharpness1 = 0, sharpness2 = 0;
      for (let i = 0; i < r1.data.length; i += 4) {
        sharpness1 += r1.data[i] - r1.data[i + 4] || 0;
        sharpness2 += r2.data[i] - r2.data[i + 4] || 0;
      }
      return 100 - Math.abs(sharpness1 - sharpness2) / 1000;
    }

    function compareGLCM(r1, r2) {
      // ØªØ¨Ø³ÙŠØ·: ÙØ±Ù‚ ØªØ¨Ø§ÙŠÙ† Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
      const contrast = (r) => {
        let c = 0;
        for (let i = 0; i < r.data.length; i += 4) {
          c += Math.pow(r.data[i] - r.data[i + 4] || 0, 2);
        }
        return c;
      };
      return 100 - Math.abs(contrast(r1) - contrast(r2)) / 5000;
    }

    function evaluateMaterialMatch(r1, r2) {
      const histogram = compareHistograms(r1, r2);
      const texture = compareTextureLBP(r1, r2);
      const glcm = compareGLCM(r1, r2);
      const finalScore = Math.round((histogram + texture + glcm) / 3);
      return { histogram, texture, glcm, finalScore };
    }

    function showFinalMatch() {
      alert("ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­. Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø§Ù„Ø£Ø³ÙÙ„.");
    }
  </script>
</body>
</html>
Ø§ÙŠÙ† Ù…ÙˆÙ‚Ø¹Ø©
