<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Analyzer 4 - ุงูุชุญูู ุงูููุฏุงูู</title>
  <style>
    body { font-family: sans-serif; direction: rtl; background: #fafafa; padding: 1em; }
    canvas { border: 1px solid #333; margin-top: 1em; }
    .control { margin-bottom: 1em; }
  </style>
</head>
<body>
  <h1>๐ฌ ุงูุชุญูู ุงูุจุตุฑู ุงูููุฏุงูู - Analyzer 4</h1>
  <div class="control">
    <label>๐ท ุงุฎุชุฑ ุตูุฑุฉ ููุชุญูู ุฃู ุงุณุชุฎุฏู ุงููุงููุฑุง:</label><br/>
    <input type="file" id="imageInput" accept="image/*" />
    <button id="cameraBtn">ุชุดุบูู ุงููุงููุฑุง</button>
    <button id="analyzeBtn">ุงุจุฏุฃ ุงููุญุต</button>
  </div>

  <video id="video" width="300" height="200" autoplay style="display:none;"></video>
  <canvas id="canvas" width="600" height="400"></canvas>
  <div id="result"></div>

  <script>
    const imageInput = document.getElementById('imageInput');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const resultDiv = document.getElementById('result');
    const video = document.getElementById('video');
    const cameraBtn = document.getElementById('cameraBtn');
    const analyzeBtn = document.getElementById('analyzeBtn');

    let sourceImage = null;

    imageInput.onchange = async () => {
      const file = imageInput.files[0];
      if (!file) return;
      const img = await loadImage(file);
      sourceImage = img;
      drawImage(img);
    };

    cameraBtn.onclick = async () => {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      video.srcObject = stream;
      video.style.display = 'block';
    };

    analyzeBtn.onclick = () => {
      if (video.style.display === 'block') {
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        resultDiv.innerHTML = `<p>๐ก ุตูุฑุฉ ูู ุงููุงููุฑุง ููุฏ ุงูุชุญููู...</p>`;
      } else if (sourceImage) {
        drawImage(sourceImage);
        resultDiv.innerHTML = `<p>๐ ุชุญููู ุงูุตูุฑุฉ ุงููุฑููุนุฉ: ุฌุงุฑู ุงุณุชุฎุฑุงุฌ ุฎุตุงุฆุต ุงููุณูุฌ ูุงูุญูุงู...</p>`;
      } else {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ุตูุฑุฉ ุฃู ุชุดุบูู ุงููุงููุฑุง.');
        return;
      }

      applySobel();
      applyGLCM();
      resultDiv.innerHTML += `<p>โ ุชู ุงุณุชุฎุฑุงุฌ ุงูุญูุงู ูุงููุณูุฌ ุจูุฌุงุญ.</p>`;
    };

    function drawImage(img) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    }

    function loadImage(file) {
      return new Promise(resolve => {
        const reader = new FileReader();
        reader.onload = () => {
          const img = new Image();
          img.onload = () => resolve(img);
          img.src = reader.result;
        };
        reader.readAsDataURL(file);
      });
    }

    function applySobel() {
      // ๐ง ุฎูุงุฑุฒููุฉ Sobel (ุชูููุฏู)
      resultDiv.innerHTML += `<p>๐ ุชุญููู ุงูุญูุงู ุจุงุณุชุฎุฏุงู Sobel: ุชู ุงูุงุณุชุฎุฑุงุฌ.</p>`;
      // ููููู ุฅุฏุฎุงู ุฎูุงุฑุฒููุฉ ูุนููุฉ ููุง ููุชุญููู ุญุณุจ ุงูุงุชุฌุงู
    }

    function applyGLCM() {
      // ๐ง ุงุณุชุฎุฑุงุฌ GLCM ุงููุจุฏุฆู
      resultDiv.innerHTML += `<p>๐ ุงุณุชุฎุฑุงุฌ ูุณูุฌ ุงูุตูุฑุฉ ุจุงุณุชุฎุฏุงู GLCM: ุฌุงูุฒ ููููุงุณ.</p>`;
      // ุฃุฏุฎู ุฎูุงุฑุฒููุฉ GLCM ูุชุญุฏูุฏ ุงูููุท ูุงูุชูุฑุงุฑ ูุงูุฅุญุตุงุฆูุงุช
    }
  </script>
</body>
</html>
